<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸ’± FX í™˜ìœ¨ AI ì°¨íŠ¸ ë¶„ì„ (ê°œì„ íŒ)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Noto Sans KR', sans-serif;
            background: linear-gradient(135deg, #0a0a1a 0%, #1a1a3a 100%);
            min-height: 100vh;
            color: #ffffff;
            padding: 15px;
            padding-bottom: 100px;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            padding: 20px 0;
            margin-bottom: 15px;
        }
        
        .header h1 {
            font-size: 1.3rem;
            margin-bottom: 8px;
            background: linear-gradient(90deg, #00d4ff, #ff0080);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header .subtitle {
            font-size: 0.85rem;
            color: #8892b0;
        }
        
        .header .free-badge {
            display: inline-block;
            background: linear-gradient(135deg, #00ff88, #00d4aa);
            color: #0a0a1a;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.75rem;
            font-weight: bold;
            margin-top: 8px;
        }
        
        .clock-box {
            background: #141428;
            border-radius: 15px;
            padding: 12px;
            margin-top: 12px;
        }
        
        .clock {
            font-size: 1rem;
            color: #00d4ff;
            font-family: 'Consolas', monospace;
            margin-bottom: 6px;
        }
        
        .market-status {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .market-status.optimal {
            background: rgba(255, 211, 42, 0.2);
            color: #ffd32a;
            border: 1px solid #ffd32a;
            animation: pulse 2s infinite;
        }
        
        .market-status.open {
            background: rgba(0, 255, 136, 0.2);
            color: #00ff88;
            border: 1px solid #00ff88;
        }
        
        .market-status.closed {
            background: rgba(136, 146, 176, 0.2);
            color: #8892b0;
            border: 1px solid #8892b0;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        /* íƒ­ */
        .tab-nav {
            display: flex;
            background: #141428;
            border-radius: 15px;
            padding: 5px;
            margin-bottom: 15px;
        }
        
        .tab-btn {
            flex: 1;
            padding: 12px 8px;
            border: none;
            background: transparent;
            color: #8892b0;
            font-size: 0.8rem;
            font-weight: 600;
            cursor: pointer;
            border-radius: 10px;
            transition: all 0.3s;
        }
        
        .tab-btn.active {
            background: linear-gradient(135deg, #00d4ff, #0080ff);
            color: #ffffff;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        /* ì¹´ë“œ */
        .step-card {
            background: #141428;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid #2a2a4a;
        }
        
        .step-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .step-number {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            background: linear-gradient(135deg, #00d4ff, #0080ff);
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1rem;
            margin-right: 12px;
        }
        
        .step-number.ai {
            background: linear-gradient(135deg, #ff0080, #9b59b6);
        }
        
        .step-title {
            flex: 1;
        }
        
        .step-title h3 {
            color: #ffffff;
            font-size: 1rem;
            margin-bottom: 3px;
        }
        
        .step-title p {
            color: #8892b0;
            font-size: 0.75rem;
        }
        
        .step-status {
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
        }
        
        .step-status.pending { background: rgba(136, 146, 176, 0.2); color: #8892b0; }
        .step-status.done { background: rgba(0, 255, 136, 0.2); color: #00ff88; }
        .step-status.analyzing { background: rgba(155, 89, 182, 0.2); color: #9b59b6; animation: pulse 1s infinite; }
        .step-status.error { background: rgba(255, 71, 87, 0.2); color: #ff4757; }
        
        /* ì°¨íŠ¸ ì—…ë¡œë“œ */
        .chart-upload-area {
            border: 2px dashed #3a3a5a;
            border-radius: 15px;
            padding: 30px 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            margin-bottom: 15px;
            position: relative;
        }
        
        .chart-upload-area:hover {
            border-color: #ff0080;
            background: rgba(255, 0, 128, 0.05);
        }
        
        .chart-upload-area .upload-icon { font-size: 3rem; margin-bottom: 15px; }
        .chart-upload-area .upload-text { font-size: 0.95rem; color: #ffffff; margin-bottom: 8px; }
        .chart-upload-area .upload-hint { font-size: 0.8rem; color: #8892b0; }
        
        .chart-upload-area input[type="file"] {
            position: absolute;
            top: 0; left: 0;
            width: 100%; height: 100%;
            opacity: 0;
            cursor: pointer;
        }
        
        .chart-preview {
            width: 100%;
            max-height: 250px;
            object-fit: contain;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        
        .chart-preview-container { position: relative; }
        
        .remove-chart-btn {
            position: absolute;
            top: 10px; right: 10px;
            width: 30px; height: 30px;
            border-radius: 50%;
            background: rgba(255, 71, 87, 0.9);
            border: none;
            color: white;
            font-size: 1.2rem;
            cursor: pointer;
        }
        
        /* URL ì…ë ¥ ì˜ì—­ */
        .url-input-section {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid #2a2a4a;
        }
        
        .url-input-section label {
            display: block;
            font-size: 0.85rem;
            color: #8892b0;
            margin-bottom: 8px;
        }
        
        .url-input-row {
            display: flex;
            gap: 8px;
        }
        
        .url-input-row input {
            flex: 1;
            padding: 12px;
            border: 1px solid #3a3a5a;
            border-radius: 10px;
            background: #1e1e3c;
            color: #ffffff;
            font-size: 0.9rem;
        }
        
        .url-input-row input:focus {
            outline: 2px solid #ff0080;
            border-color: #ff0080;
        }
        
        .url-fetch-btn {
            padding: 12px 16px;
            border: none;
            border-radius: 10px;
            background: linear-gradient(135deg, #ff0080, #9b59b6);
            color: white;
            font-size: 0.9rem;
            cursor: pointer;
            white-space: nowrap;
        }
        
        /* AI ë¶„ì„ ì§„í–‰ */
        .ai-progress {
            background: linear-gradient(135deg, #1a1a3a, #2a1a4a);
            border: 1px solid #9b59b6;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            display: none;
        }
        
        .ai-progress.show { display: block; }
        
        .ai-progress-header {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 15px;
        }
        
        .ai-spinner {
            width: 25px; height: 25px;
            border: 3px solid #2a2a4a;
            border-top-color: #9b59b6;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin { to { transform: rotate(360deg); } }
        
        .ai-progress-header h4 { color: #9b59b6; font-size: 0.95rem; }
        
        .ai-progress-steps {
            display: flex;
            flex-direction: column;
            gap: 8px;
        }
        
        .ai-step {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 8px 12px;
            background: rgba(155, 89, 182, 0.1);
            border-radius: 8px;
            font-size: 0.85rem;
            color: #8892b0;
            transition: all 0.3s;
        }
        
        .ai-step.active { color: #9b59b6; background: rgba(155, 89, 182, 0.2); }
        .ai-step.done { color: #00ff88; background: rgba(0, 255, 136, 0.1); }
        .ai-step.done::before { content: 'âœ“ '; }
        
        /* AI ê²°ê³¼ */
        .ai-result-card {
            background: linear-gradient(135deg, #1a1a3a, #2a1a4a);
            border: 1px solid #9b59b6;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            display: none;
        }
        
        .ai-result-card.show { display: block; animation: fadeIn 0.5s ease; }
        
        .ai-result-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px solid #3a3a5a;
        }
        
        .ai-result-header h4 { color: #9b59b6; font-size: 1rem; }
        
        .ai-badge {
            background: linear-gradient(135deg, #9b59b6, #8e44ad);
            padding: 3px 8px;
            border-radius: 10px;
            font-size: 0.7rem;
            color: white;
        }
        
        .ai-value-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px 0;
            border-bottom: 1px solid #2a2a4a;
        }
        
        .ai-value-row:last-child { border-bottom: none; }
        .ai-value-label { font-size: 0.85rem; color: #8892b0; }
        .ai-value { font-size: 1rem; font-weight: bold; color: #ffffff; }
        .ai-value.up { color: #00ff88; }
        .ai-value.down { color: #ff4757; }
        .ai-value.neutral { color: #ffd32a; }
        .ai-value.overbought { color: #ff4757; }
        .ai-value.oversold { color: #00ff88; }
        
        .ai-comment {
            background: rgba(155, 89, 182, 0.1);
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
        }
        
        .ai-comment-title { font-size: 0.85rem; color: #9b59b6; margin-bottom: 8px; }
        .ai-comment-text { font-size: 0.85rem; color: #c0c0c0; line-height: 1.6; }
        
        /* ì…ë ¥ í•„ë“œ */
        .input-row {
            display: flex;
            align-items: center;
            gap: 10px;
            background: #1e1e3c;
            border-radius: 12px;
            padding: 12px 15px;
            margin-bottom: 10px;
        }
        
        .input-row label {
            font-size: 0.85rem;
            color: #8892b0;
            white-space: nowrap;
            min-width: 80px;
        }
        
        .input-row input {
            flex: 1;
            padding: 10px;
            border: none;
            border-radius: 8px;
            background: #141428;
            color: #ffffff;
            font-size: 1.1rem;
            text-align: right;
            font-weight: bold;
        }
        
        .input-row input:focus { outline: 2px solid #00d4ff; }
        .input-row .unit { font-size: 0.9rem; color: #8892b0; }
        
        /* ë²„íŠ¼ */
        .fetch-btn {
            width: 100%;
            padding: 15px;
            border: none;
            border-radius: 12px;
            font-size: 0.95rem;
            font-weight: bold;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: all 0.3s;
            margin-bottom: 12px;
        }
        
        .fetch-btn.investing {
            background: linear-gradient(135deg, #1a3a1a, #0a2a0a);
            border: 2px solid #00ff88;
            color: #00ff88;
        }
        
        .fetch-btn.barchart {
            background: linear-gradient(135deg, #1a1a3a, #0a0a2a);
            border: 2px solid #00d4ff;
            color: #00d4ff;
        }
        
        .fetch-btn:active { transform: scale(0.98); }
        
        .analyze-btn {
            width: 100%;
            padding: 18px;
            border: none;
            border-radius: 15px;
            background: linear-gradient(90deg, #ff0080, #9b59b6);
            color: white;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            margin-bottom: 15px;
            box-shadow: 0 5px 20px rgba(255, 0, 128, 0.3);
            transition: all 0.3s;
        }
        
        .analyze-btn:disabled {
            background: linear-gradient(90deg, #4a4a6a, #3a3a5a);
            box-shadow: none;
            cursor: not-allowed;
        }
        
        .analyze-btn:active:not(:disabled) { transform: scale(0.98); }
        .analyze-btn .sub-text { font-size: 0.75rem; font-weight: normal; opacity: 0.8; display: block; margin-top: 4px; }
        
        /* íƒ€ì„í”„ë ˆì„ */
        .timeframe-options {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 15px;
        }
        
        .timeframe-btn {
            padding: 8px 14px;
            border-radius: 20px;
            background: #1e1e3c;
            border: 1px solid #3a3a5a;
            color: #8892b0;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .timeframe-btn.active {
            background: linear-gradient(135deg, #ff0080, #9b59b6);
            border-color: #ff0080;
            color: #ffffff;
        }
        
        /* íˆ¬ìê¸ˆ */
        .invest-section {
            background: #141428;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #2a2a4a;
        }
        
        .invest-section h4 { color: #8892b0; font-size: 0.85rem; margin-bottom: 10px; }
        
        .invest-options {
            display: flex;
            gap: 8px;
            flex-wrap: wrap;
            margin-bottom: 10px;
        }
        
        .invest-option {
            padding: 8px 15px;
            border-radius: 20px;
            background: #1e1e3c;
            border: 1px solid #3a3a5a;
            color: #8892b0;
            font-size: 0.85rem;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .invest-option.active {
            background: linear-gradient(135deg, #00d4ff, #0080ff);
            border-color: #00d4ff;
            color: #ffffff;
        }
        
        .invest-custom {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        
        .invest-custom input {
            flex: 1;
            padding: 10px;
            border: 1px solid #3a3a5a;
            border-radius: 8px;
            background: #1e1e3c;
            color: #ffffff;
            font-size: 1rem;
            text-align: right;
        }
        
        .invest-custom span { color: #8892b0; font-size: 0.9rem; }
        
        /* ë„ì›€ë§ */
        .help-text {
            background: rgba(255, 211, 42, 0.1);
            border: 1px solid rgba(255, 211, 42, 0.3);
            border-radius: 10px;
            padding: 12px;
            margin-top: 12px;
            font-size: 0.8rem;
            color: #ffd32a;
            line-height: 1.5;
        }
        
        .help-text strong { color: #ffffff; }
        .help-text.ai { background: rgba(155, 89, 182, 0.1); border-color: rgba(155, 89, 182, 0.3); color: #9b59b6; }
        .help-text.success { background: rgba(0, 255, 136, 0.1); border-color: rgba(0, 255, 136, 0.3); color: #00ff88; }
        
        /* ==================== ê²°ê³¼ ì˜ì—­ ==================== */
        .result-area { display: none; }
        .result-area.show { display: block; animation: slideUp 0.5s ease; }
        
        @keyframes slideUp {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .analysis-badge {
            display: inline-flex;
            align-items: center;
            gap: 8px;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.75rem;
            margin-bottom: 15px;
        }
        
        .analysis-badge.ai {
            background: rgba(155, 89, 182, 0.2);
            color: #9b59b6;
            border: 1px solid #9b59b6;
        }
        
        .analysis-badge.ndf {
            background: rgba(0, 212, 255, 0.2);
            color: #00d4ff;
            border: 1px solid #00d4ff;
        }
        
        .analysis-badge.combined {
            background: linear-gradient(90deg, rgba(0, 212, 255, 0.2), rgba(155, 89, 182, 0.2));
            color: #ffffff;
            border: 1px solid #8892b0;
        }
        
        /* ë©”ì¸ ì‹œê·¸ë„ */
        .main-signal {
            border-radius: 20px;
            padding: 25px 20px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .main-signal.sell-krw {
            background: linear-gradient(135deg, #0a2a1a, #0a1a0a);
            border: 2px solid #00ff88;
        }
        
        .main-signal.buy-krw {
            background: linear-gradient(135deg, #2a0a1a, #1a0a0a);
            border: 2px solid #ff4757;
        }
        
        .main-signal.hold {
            background: linear-gradient(135deg, #2a2a0a, #1a1a0a);
            border: 2px solid #ffd32a;
        }
        
        .signal-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 15px;
            font-size: 0.7rem;
            margin-bottom: 12px;
        }
        
        .main-signal.sell-krw .signal-badge { background: rgba(0, 255, 136, 0.2); color: #00ff88; }
        .main-signal.buy-krw .signal-badge { background: rgba(255, 71, 87, 0.2); color: #ff4757; }
        .main-signal.hold .signal-badge { background: rgba(255, 211, 42, 0.2); color: #ffd32a; }
        
        .signal-icon { font-size: 3.5rem; margin-bottom: 8px; }
        .signal-title { font-size: 1.8rem; font-weight: bold; margin-bottom: 6px; }
        
        .main-signal.sell-krw .signal-title { color: #00ff88; }
        .main-signal.buy-krw .signal-title { color: #ff4757; }
        .main-signal.hold .signal-title { color: #ffd32a; }
        
        .signal-desc { font-size: 1rem; color: #c0c0c0; margin-bottom: 15px; }
        
        .confidence-section { margin-top: 15px; }
        .confidence-label { font-size: 0.8rem; color: #8892b0; margin-bottom: 6px; }
        
        .confidence-bar-bg {
            background: rgba(255,255,255,0.1);
            height: 10px;
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 6px;
        }
        
        .confidence-bar-fill {
            height: 100%;
            border-radius: 5px;
            transition: width 1s ease;
        }
        
        .main-signal.sell-krw .confidence-bar-fill { background: linear-gradient(90deg, #00ff88, #00d4aa); }
        .main-signal.buy-krw .confidence-bar-fill { background: linear-gradient(90deg, #ff4757, #ff6b7a); }
        .main-signal.hold .confidence-bar-fill { background: linear-gradient(90deg, #ffd32a, #ffdd55); }
        
        .confidence-value { font-size: 1rem; font-weight: bold; color: #ffffff; }
        
        /* ê°€ê²© ê°€ì´ë“œ */
        .price-guide {
            background: #141428;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid #2a2a4a;
        }
        
        .price-guide h3 { color: #00d4ff; font-size: 1rem; margin-bottom: 15px; text-align: center; }
        
        .price-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px;
            background: #1e1e3c;
            border-radius: 10px;
            margin-bottom: 8px;
        }
        
        .price-item:last-child { margin-bottom: 0; }
        
        .price-label {
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .price-icon {
            width: 40px; height: 40px;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2rem;
        }
        
        .price-icon.entry { background: rgba(0, 212, 255, 0.2); }
        .price-icon.target { background: rgba(0, 255, 136, 0.2); }
        .price-icon.stop { background: rgba(255, 71, 87, 0.2); }
        
        .price-text .main-label { font-size: 0.85rem; color: #ffffff; font-weight: 600; }
        .price-text .sub-label { font-size: 0.7rem; color: #8892b0; }
        
        .price-value { text-align: right; }
        .price-value .amount { font-size: 1.2rem; font-weight: bold; color: #ffffff; }
        .price-value .change { font-size: 0.75rem; }
        .price-value .change.positive { color: #00ff88; }
        .price-value .change.negative { color: #ff4757; }
        
        /* ìˆ˜ìµ/ì†ì‹¤ */
        .profit-loss-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .profit-card, .loss-card {
            border-radius: 12px;
            padding: 15px;
            text-align: center;
        }
        
        .profit-card { background: linear-gradient(135deg, #0a2a1a, #0a1a0a); border: 1px solid #00ff88; }
        .loss-card { background: linear-gradient(135deg, #2a0a1a, #1a0a0a); border: 1px solid #ff4757; }
        
        .profit-card h4 { color: #00ff88; font-size: 0.75rem; margin-bottom: 8px; }
        .loss-card h4 { color: #ff4757; font-size: 0.75rem; margin-bottom: 8px; }
        
        .profit-amount { font-size: 1.3rem; font-weight: bold; color: #00ff88; }
        .loss-amount { font-size: 1.3rem; font-weight: bold; color: #ff4757; }
        
        .profit-desc, .loss-desc { font-size: 0.7rem; color: #8892b0; margin-top: 4px; }
        
        /* ì „ëµ */
        .strategy-section {
            background: #141428;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid #2a2a4a;
        }
        
        .strategy-section h3 { color: #ff0080; font-size: 1rem; margin-bottom: 15px; text-align: center; }
        
        .strategy-item {
            display: flex;
            padding: 12px 0;
            border-bottom: 1px solid #2a2a4a;
        }
        
        .strategy-item:last-child { border-bottom: none; }
        
        .strategy-num {
            width: 28px; height: 28px;
            border-radius: 50%;
            background: linear-gradient(135deg, #ff0080, #9b59b6);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.8rem;
            font-weight: bold;
            margin-right: 12px;
            flex-shrink: 0;
        }
        
        .strategy-content { flex: 1; }
        .strategy-title { font-size: 0.9rem; color: #ffffff; font-weight: 600; margin-bottom: 4px; }
        .strategy-desc { font-size: 0.8rem; color: #8892b0; line-height: 1.4; }
        
        /* ë°ì´í„° ìš”ì•½ */
        .data-summary {
            background: #141428;
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 15px;
            border: 1px solid #2a2a4a;
        }
        
        .data-summary h3 { color: #00d4ff; font-size: 0.9rem; margin-bottom: 12px; }
        
        .data-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid #2a2a4a;
            font-size: 0.85rem;
        }
        
        .data-row:last-child { border-bottom: none; }
        .data-label { color: #8892b0; }
        .data-value { color: #ffffff; font-weight: 600; }
        .data-value.up { color: #00ff88; }
        .data-value.down { color: #ff4757; }
        
        /* ì£¼ì˜ì‚¬í•­ */
        .warning-box {
            background: rgba(255, 71, 87, 0.1);
            border: 1px solid #ff4757;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 15px;
        }
        
        .warning-box h4 { color: #ff4757; font-size: 0.85rem; margin-bottom: 10px; }
        .warning-list { list-style: none; }
        
        .warning-list li {
            font-size: 0.75rem;
            color: #c0c0c0;
            padding: 4px 0 4px 20px;
            position: relative;
            line-height: 1.4;
        }
        
        .warning-list li::before {
            content: 'âš ï¸';
            position: absolute;
            left: 0;
            font-size: 0.65rem;
        }
        
        .reset-btn {
            width: 100%;
            padding: 12px;
            border: 2px solid #3a3a5a;
            border-radius: 10px;
            background: transparent;
            color: #8892b0;
            font-size: 0.9rem;
            cursor: pointer;
            margin-bottom: 15px;
        }
        
        .reset-btn:active { background: #1e1e3c; }
        
        .footer {
            text-align: center;
            padding: 20px;
            color: #8892b0;
            font-size: 0.7rem;
        }
        
        /* ìˆ˜ë™ ì…ë ¥ ì„¹ì…˜ */
        .manual-input-section {
            background: #141428;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 15px;
            border: 1px solid #3a3a5a;
        }
        
        .manual-input-section h4 {
            color: #ff0080;
            font-size: 0.95rem;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .manual-input-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }
        
        .manual-input-item {
            display: flex;
            flex-direction: column;
            gap: 4px;
        }
        
        .manual-input-item label {
            font-size: 0.75rem;
            color: #8892b0;
        }
        
        .manual-input-item input {
            padding: 10px;
            border: 1px solid #3a3a5a;
            border-radius: 8px;
            background: #1e1e3c;
            color: #ffffff;
            font-size: 0.95rem;
            text-align: right;
        }
        
        .manual-input-item input:focus {
            outline: 2px solid #ff0080;
            border-color: #ff0080;
        }
        
        .manual-input-item.full {
            grid-column: 1 / -1;
        }
        
        .manual-input-item select {
            padding: 10px;
            border: 1px solid #3a3a5a;
            border-radius: 8px;
            background: #1e1e3c;
            color: #ffffff;
            font-size: 0.95rem;
        }
        
        .manual-analyze-btn {
            width: 100%;
            padding: 15px;
            margin-top: 15px;
            border: none;
            border-radius: 12px;
            background: linear-gradient(90deg, #00d4ff, #0080ff);
            color: white;
            font-size: 1rem;
            font-weight: bold;
            cursor: pointer;
        }
        
        .or-divider {
            text-align: center;
            color: #8892b0;
            font-size: 0.85rem;
            margin: 15px 0;
            position: relative;
        }
        
        .or-divider::before,
        .or-divider::after {
            content: '';
            position: absolute;
            top: 50%;
            width: 40%;
            height: 1px;
            background: #3a3a5a;
        }
        
        .or-divider::before { left: 0; }
        .or-divider::after { right: 0; }
    </style>
</head>
<body>
    <div class="container">
        
        <header class="header">
            <h1>ğŸ’± FX í™˜ìœ¨ AI ì°¨íŠ¸ ë¶„ì„</h1>
            <p class="subtitle">ì°¨íŠ¸ ìº¡ì²˜ â†’ AI ìë™ ë¶„ì„ â†’ ë§¤ë§¤ í¬ì¸íŠ¸!</p>
            <div class="free-badge">ğŸ†“ ë¬´ë£Œ Â· API í‚¤ ë¶ˆí•„ìš”</div>
            
            <div class="clock-box">
                <div class="clock" id="clock">ğŸ‡°ğŸ‡· 2026-01-12 14:00:00</div>
                <div class="market-status" id="marketStatus">ğŸŸ¢ í•œêµ­ ì‹œì¥ ê±°ë˜ ì¤‘</div>
            </div>
        </header>
        
        <div class="tab-nav">
            <button class="tab-btn active" onclick="switchTab('ndf')">ğŸ“Š NDF</button>
            <button class="tab-btn" onclick="switchTab('chart')">ğŸ¤– AIì°¨íŠ¸</button>
            <button class="tab-btn" onclick="switchTab('combined')">ğŸ”¥ ë³µí•©</button>
        </div>
        
        <!-- NDF íƒ­ -->
        <div class="tab-content active" id="tab-ndf">
            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div class="step-title">
                        <h3>ğŸ“Š ì „ì¼ ì¢…ê°€</h3>
                        <p>Investing.comì—ì„œ í™•ì¸</p>
                    </div>
                    <div class="step-status pending" id="step1Status">ëŒ€ê¸°ì¤‘</div>
                </div>
                
                <button class="fetch-btn investing" onclick="window.open('https://kr.investing.com/currencies/usd-krw','_blank')">
                    ğŸ“Š Investing.com ì—´ê¸°
                </button>
                
                <div class="input-row">
                    <label>ì „ì¼ ì¢…ê°€</label>
                    <input type="number" id="prevClose" placeholder="1450.00" step="0.01" onchange="checkNdfInputs()">
                    <span class="unit">ì›</span>
                </div>
            </div>
            
            <div class="step-card">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div class="step-title">
                        <h3>ğŸŒ™ í˜„ì¬ NDF</h3>
                        <p>Barchartì—ì„œ í™•ì¸</p>
                    </div>
                    <div class="step-status pending" id="step2Status">ëŒ€ê¸°ì¤‘</div>
                </div>
                
                <button class="fetch-btn barchart" onclick="window.open('https://www.barchart.com/forex/quotes/%5EUSDKRW/forward-rates','_blank')">
                    ğŸ“ˆ Barchart ì—´ê¸°
                </button>
                
                <div class="input-row">
                    <label>NDF í˜„ì¬ê°€</label>
                    <input type="number" id="ndfRate" placeholder="1465.00" step="0.01" onchange="checkNdfInputs()">
                    <span class="unit">ì›</span>
                </div>
            </div>
            
            <div class="invest-section">
                <h4>ğŸ’° íˆ¬ì ì˜ˆì • ê¸ˆì•¡</h4>
                <div class="invest-options">
                    <div class="invest-option" onclick="setInvestment(500000)">50ë§Œ</div>
                    <div class="invest-option active" onclick="setInvestment(1000000)">100ë§Œ</div>
                    <div class="invest-option" onclick="setInvestment(3000000)">300ë§Œ</div>
                    <div class="invest-option" onclick="setInvestment(5000000)">500ë§Œ</div>
                </div>
                <div class="invest-custom">
                    <span>ì§ì ‘ì…ë ¥:</span>
                    <input type="number" id="investment" value="1000000">
                    <span>ì›</span>
                </div>
            </div>
            
            <button class="analyze-btn" id="ndfAnalyzeBtn" onclick="analyzeNdf()" disabled>
                ğŸš€ NDF ë¶„ì„ ì‹œì‘
                <span class="sub-text">ì „ì¼ ì¢…ê°€ì™€ NDFë¥¼ ì…ë ¥í•˜ì„¸ìš”</span>
            </button>
        </div>
        
        <!-- AI ì°¨íŠ¸ íƒ­ -->
        <div class="tab-content" id="tab-chart">
            <div class="step-card">
                <div class="step-header">
                    <div class="step-number ai">ğŸ¤–</div>
                    <div class="step-title">
                        <h3>ì°¨íŠ¸ ì´ë¯¸ì§€ ì—…ë¡œë“œ</h3>
                        <p>AIê°€ ìë™ìœ¼ë¡œ ë¶„ì„í•´ìš”!</p>
                    </div>
                    <div class="step-status pending" id="chartStatus">ëŒ€ê¸°ì¤‘</div>
                </div>
                
                <div class="chart-upload-area" id="uploadArea">
                    <div class="upload-icon">ğŸ“¤</div>
                    <div class="upload-text">ì°¨íŠ¸ ì´ë¯¸ì§€ë¥¼ ì—…ë¡œë“œí•˜ì„¸ìš”</div>
                    <div class="upload-hint">ì¸ë² ìŠ¤íŒ…/íŠ¸ë ˆì´ë”©ë·° ì°¨íŠ¸ ìº¡ì²˜<br>AIê°€ ìë™ìœ¼ë¡œ ì§€ì§€/ì €í•­ì„  ë¶„ì„!</div>
                    <input type="file" id="chartFile" accept="image/*" onchange="handleChartUpload(event)">
                </div>
                
                <div class="chart-preview-container" id="previewContainer" style="display:none;">
                    <img id="chartPreview" class="chart-preview" src="" alt="ì°¨íŠ¸">
                    <button class="remove-chart-btn" onclick="removeChart()">Ã—</button>
                </div>
                
                <!-- URL ì…ë ¥ ì˜µì…˜ -->
                <div class="url-input-section">
                    <label>ë˜ëŠ” ì´ë¯¸ì§€ URL ì§ì ‘ ì…ë ¥:</label>
                    <div class="url-input-row">
                        <input type="text" id="chartUrl" placeholder="https://example.com/chart.png">
                        <button class="url-fetch-btn" onclick="fetchChartFromUrl()">ë¶ˆëŸ¬ì˜¤ê¸°</button>
                    </div>
                </div>
                
                <div class="help-text ai">
                    ğŸ¤– <strong>Pollinations.ai Vision API</strong>ë¥¼ ì‚¬ìš©í•´ìš”. ë¬´ë£Œì´ê³  API í‚¤ê°€ í•„ìš” ì—†ì–´ìš”!
                </div>
            </div>
            
            <!-- AI ë¶„ì„ ì§„í–‰ ìƒíƒœ -->
            <div class="ai-progress" id="aiProgress">
                <div class="ai-progress-header">
                    <div class="ai-spinner"></div>
                    <h4>AIê°€ ì°¨íŠ¸ë¥¼ ë¶„ì„í•˜ê³  ìˆì–´ìš”...</h4>
                </div>
                <div class="ai-progress-steps">
                    <div class="ai-step" id="aiStep1">ì´ë¯¸ì§€ ì „ì†¡ ì¤‘...</div>
                    <div class="ai-step" id="aiStep2">ì°¨íŠ¸ íŒ¨í„´ ë¶„ì„ ì¤‘...</div>
                    <div class="ai-step" id="aiStep3">ì§€ì§€/ì €í•­ì„  íƒì§€ ì¤‘...</div>
                    <div class="ai-step" id="aiStep4">ë§¤ë§¤ ì‹œê·¸ë„ ìƒì„± ì¤‘...</div>
                </div>
            </div>
            
            <!-- AI ë¶„ì„ ê²°ê³¼ -->
            <div class="ai-result-card" id="aiResultCard">
                <div class="ai-result-header">
                    <span style="font-size:1.5rem;">ğŸ¤–</span>
                    <h4>AI ë¶„ì„ ê²°ê³¼</h4>
                    <span class="ai-badge">AI Vision</span>
                </div>
                
                <div class="ai-value-row">
                    <span class="ai-value-label">í˜„ì¬ê°€</span>
                    <span class="ai-value" id="aiCurrentPrice">-</span>
                </div>
                <div class="ai-value-row">
                    <span class="ai-value-label">1ì°¨ ì €í•­ì„ </span>
                    <span class="ai-value down" id="aiResistance1">-</span>
                </div>
                <div class="ai-value-row">
                    <span class="ai-value-label">2ì°¨ ì €í•­ì„ </span>
                    <span class="ai-value down" id="aiResistance2">-</span>
                </div>
                <div class="ai-value-row">
                    <span class="ai-value-label">1ì°¨ ì§€ì§€ì„ </span>
                    <span class="ai-value up" id="aiSupport1">-</span>
                </div>
                <div class="ai-value-row">
                    <span class="ai-value-label">2ì°¨ ì§€ì§€ì„ </span>
                    <span class="ai-value up" id="aiSupport2">-</span>
                </div>
                <div class="ai-value-row">
                    <span class="ai-value-label">RSI</span>
                    <span class="ai-value" id="aiRSI">-</span>
                </div>
                <div class="ai-value-row">
                    <span class="ai-value-label">ì¶”ì„¸ ë°©í–¥</span>
                    <span class="ai-value" id="aiTrend">-</span>
                </div>
                <div class="ai-value-row">
                    <span class="ai-value-label">ê°ì§€ íŒ¨í„´</span>
                    <span class="ai-value" id="aiPatterns">-</span>
                </div>
                
                <div class="ai-comment">
                    <div class="ai-comment-title">ğŸ’¬ AI ì½”ë©˜íŠ¸</div>
                    <div class="ai-comment-text" id="aiComment">ë¶„ì„ ê²°ê³¼ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>
                </div>
            </div>
            
            <div class="or-divider">ë˜ëŠ” ìˆ˜ë™ìœ¼ë¡œ ì…ë ¥</div>
            
            <!-- ìˆ˜ë™ ì…ë ¥ ì„¹ì…˜ -->
            <div class="manual-input-section" id="manualInputSection">
                <h4>ğŸ“ ì°¨íŠ¸ ì •ë³´ ìˆ˜ë™ ì…ë ¥</h4>
                <p style="font-size:0.8rem;color:#8892b0;text-align:center;margin-bottom:15px;">
                    AIê°€ ì´ë¯¸ì§€ë¥¼ ì½ì§€ ëª»í•  ê²½ìš° ì§ì ‘ ì…ë ¥í•˜ì„¸ìš”
                </p>
                
                <div class="manual-input-grid">
                    <div class="manual-input-item">
                        <label>í˜„ì¬ê°€ (ì›)</label>
                        <input type="number" id="manualCurrentPrice" placeholder="1468.14" step="0.01">
                    </div>
                    <div class="manual-input-item">
                        <label>RSI</label>
                        <input type="number" id="manualRSI" placeholder="73.65" step="0.01">
                    </div>
                    <div class="manual-input-item">
                        <label>ë³¼ë¦°ì € ìƒë‹¨</label>
                        <input type="number" id="manualBBUpper" placeholder="1478.77" step="0.01">
                    </div>
                    <div class="manual-input-item">
                        <label>ë³¼ë¦°ì € í•˜ë‹¨</label>
                        <input type="number" id="manualBBLower" placeholder="1441.45" step="0.01">
                    </div>
                    <div class="manual-input-item">
                        <label>1ì°¨ ì €í•­ì„ </label>
                        <input type="number" id="manualResistance1" placeholder="1478" step="0.01">
                    </div>
                    <div class="manual-input-item">
                        <label>1ì°¨ ì§€ì§€ì„ </label>
                        <input type="number" id="manualSupport1" placeholder="1460" step="0.01">
                    </div>
                    <div class="manual-input-item full">
                        <label>ì¶”ì„¸ ë°©í–¥</label>
                        <select id="manualTrend">
                            <option value="up">ğŸ“ˆ ìƒìŠ¹</option>
                            <option value="down">ğŸ“‰ í•˜ë½</option>
                            <option value="sideways">â¡ï¸ íš¡ë³´</option>
                        </select>
                    </div>
                </div>
                
                <button class="manual-analyze-btn" onclick="analyzeManualInput()">
                    ğŸ“Š ìˆ˜ë™ ì…ë ¥ìœ¼ë¡œ ë¶„ì„í•˜ê¸°
                </button>
            </div>
            
            <div class="step-card" id="timeframeCard" style="display:none;">
                <div class="step-header">
                    <div class="step-number ai">â°</div>
                    <div class="step-title">
                        <h3>íƒ€ì„í”„ë ˆì„</h3>
                        <p>ì°¨íŠ¸ì˜ ì‹œê°„ ë‹¨ìœ„</p>
                    </div>
                </div>
                <div class="timeframe-options">
                    <button class="timeframe-btn" onclick="setTimeframe('5m',this)">5ë¶„</button>
                    <button class="timeframe-btn" onclick="setTimeframe('15m',this)">15ë¶„</button>
                    <button class="timeframe-btn active" onclick="setTimeframe('1h',this)">1ì‹œê°„</button>
                    <button class="timeframe-btn" onclick="setTimeframe('4h',this)">4ì‹œê°„</button>
                    <button class="timeframe-btn" onclick="setTimeframe('1d',this)">ì¼ë´‰</button>
                </div>
            </div>
            
            <div class="invest-section">
                <h4>ğŸ’° íˆ¬ì ì˜ˆì • ê¸ˆì•¡</h4>
                <div class="invest-options">
                    <div class="invest-option" onclick="setInvestment(500000)">50ë§Œ</div>
                    <div class="invest-option active" onclick="setInvestment(1000000)">100ë§Œ</div>
                    <div class="invest-option" onclick="setInvestment(3000000)">300ë§Œ</div>
                    <div class="invest-option" onclick="setInvestment(5000000)">500ë§Œ</div>
                </div>
                <div class="invest-custom">
                    <span>ì§ì ‘ì…ë ¥:</span>
                    <input type="number" id="investmentChart" value="1000000">
                    <span>ì›</span>
                </div>
            </div>
            
            <button class="analyze-btn" id="chartAnalyzeBtn" onclick="finalizeChartAnalysis()" disabled>
                ğŸ¤– AI ë¶„ì„ ê²°ê³¼ë¡œ ë§¤ë§¤ ê°€ì´ë“œ ë°›ê¸°
                <span class="sub-text">ì°¨íŠ¸ë¥¼ ì—…ë¡œë“œí•˜ê±°ë‚˜ ìˆ˜ë™ ì…ë ¥í•˜ì„¸ìš”</span>
            </button>
        </div>
        
        <!-- ë³µí•© ë¶„ì„ íƒ­ -->
        <div class="tab-content" id="tab-combined">
            <div class="step-card" style="border-color:#ff0080;">
                <div class="step-header">
                    <div class="step-number" style="background:linear-gradient(135deg,#00d4ff,#ff0080);">â˜…</div>
                    <div class="step-title">
                        <h3>ğŸ”¥ NDF + AI ì°¨íŠ¸ ë³µí•©</h3>
                        <p>ë‘ ë¶„ì„ì„ ê²°í•©í•œ ìµœê°• ì‹œê·¸ë„</p>
                    </div>
                </div>
                
                <div style="text-align:center;padding:20px 0;">
                    <p style="color:#8892b0;font-size:0.85rem;margin-bottom:15px;">
                        ë‘ ë¶„ì„ì„ <strong style="color:#ff0080;">ëª¨ë‘ ì™„ë£Œ</strong>í•œ í›„<br>ë³µí•© ì‹œê·¸ë„ì„ ë°›ìœ¼ì„¸ìš”!
                    </p>
                    
                    <div style="display:flex;gap:12px;justify-content:center;margin-bottom:15px;">
                        <div style="text-align:center;">
                            <div id="ndfCheck" style="font-size:1.8rem;">â¬œ</div>
                            <div style="font-size:0.75rem;color:#8892b0;">NDF</div>
                        </div>
                        <div style="font-size:1.8rem;color:#3a3a5a;">+</div>
                        <div style="text-align:center;">
                            <div id="chartCheck" style="font-size:1.8rem;">â¬œ</div>
                            <div style="font-size:0.75rem;color:#8892b0;">AIì°¨íŠ¸</div>
                        </div>
                        <div style="font-size:1.8rem;color:#3a3a5a;">=</div>
                        <div style="text-align:center;">
                            <div style="font-size:1.8rem;">ğŸ”¥</div>
                            <div style="font-size:0.75rem;color:#ff0080;">ë³µí•©</div>
                        </div>
                    </div>
                </div>
                
                <button class="analyze-btn" id="combinedBtn" onclick="analyzeCombined()" disabled>
                    ğŸ”¥ ë³µí•© ë¶„ì„ ì‹œì‘
                    <span class="sub-text">NDFì™€ AIì°¨íŠ¸ ë¶„ì„ì„ ë¨¼ì € ì™„ë£Œí•˜ì„¸ìš”</span>
                </button>
            </div>
        </div>
        
        <!-- ê²°ê³¼ ì˜ì—­ -->
        <div class="result-area" id="resultArea">
            <div style="text-align:center;">
                <span class="analysis-badge ai" id="analysisBadge">ğŸ¤– AI ì°¨íŠ¸ ë¶„ì„</span>
            </div>
            
            <div class="main-signal" id="mainSignal">
                <div class="signal-badge" id="signalBadge">ì˜¤ëŠ˜ì˜ ì¶”ì²œ</div>
                <div class="signal-icon" id="signalIcon">ğŸŸ¢</div>
                <div class="signal-title" id="signalTitle">ì›í™” ë§¤ë„</div>
                <div class="signal-desc" id="signalDesc">ë‹¬ëŸ¬ë¥¼ ì‚¬ì„¸ìš”!</div>
                
                <div class="confidence-section">
                    <div class="confidence-label">ì‹œê·¸ë„ ì‹ ë¢°ë„</div>
                    <div class="confidence-bar-bg">
                        <div class="confidence-bar-fill" id="confidenceFill" style="width:0%"></div>
                    </div>
                    <div class="confidence-value" id="confidenceValue">75%</div>
                </div>
            </div>
            
            <div class="price-guide">
                <h3>ğŸ’° ë§¤ë§¤ ê°€ê²© ê°€ì´ë“œ</h3>
                
                <div class="price-item">
                    <div class="price-label">
                        <div class="price-icon entry">ğŸ¯</div>
                        <div class="price-text">
                            <div class="main-label">ì§„ì…ê°€</div>
                            <div class="sub-label">ì´ ê°€ê²©ì— ì‹œì‘</div>
                        </div>
                    </div>
                    <div class="price-value">
                        <div class="amount" id="entryPrice">1,455ì›</div>
                    </div>
                </div>
                
                <div class="price-item">
                    <div class="price-label">
                        <div class="price-icon target">ğŸ†</div>
                        <div class="price-text">
                            <div class="main-label">ëª©í‘œê°€</div>
                            <div class="sub-label">ìˆ˜ìµ ì‹¤í˜„</div>
                        </div>
                    </div>
                    <div class="price-value">
                        <div class="amount" id="targetPrice">1,470ì›</div>
                        <div class="change positive" id="targetChange">+15ì›</div>
                    </div>
                </div>
                
                <div class="price-item">
                    <div class="price-label">
                        <div class="price-icon stop">ğŸ›‘</div>
                        <div class="price-text">
                            <div class="main-label">ì†ì ˆê°€</div>
                            <div class="sub-label">ì†ì‹¤ ì œí•œ</div>
                        </div>
                    </div>
                    <div class="price-value">
                        <div class="amount" id="stopPrice">1,440ì›</div>
                        <div class="change negative" id="stopChange">-15ì›</div>
                    </div>
                </div>
            </div>
            
            <div class="profit-loss-row">
                <div class="profit-card">
                    <h4>ğŸ“ˆ ì˜ˆìƒ ìˆ˜ìµ</h4>
                    <div class="profit-amount" id="maxProfit">+10,000ì›</div>
                    <div class="profit-desc" id="profitDesc">ëª©í‘œê°€ ë„ë‹¬ ì‹œ</div>
                </div>
                <div class="loss-card">
                    <h4>ğŸ“‰ ì˜ˆìƒ ì†ì‹¤</h4>
                    <div class="loss-amount" id="maxLoss">-10,000ì›</div>
                    <div class="loss-desc">ì†ì ˆê°€ ë„ë‹¬ ì‹œ</div>
                </div>
            </div>
            
            <div class="strategy-section">
                <h3>ğŸ“‹ ì‹¤ì „ ì „ëµ</h3>
                <div class="strategy-item">
                    <div class="strategy-num">1</div>
                    <div class="strategy-content">
                        <div class="strategy-title" id="strat1Title">ì§„ì… íƒ€ì´ë°</div>
                        <div class="strategy-desc" id="strat1Desc">ì „ëµ ì„¤ëª…</div>
                    </div>
                </div>
                <div class="strategy-item">
                    <div class="strategy-num">2</div>
                    <div class="strategy-content">
                        <div class="strategy-title" id="strat2Title">ìˆ˜ìµ ì‹¤í˜„</div>
                        <div class="strategy-desc" id="strat2Desc">ì „ëµ ì„¤ëª…</div>
                    </div>
                </div>
                <div class="strategy-item">
                    <div class="strategy-num">3</div>
                    <div class="strategy-content">
                        <div class="strategy-title" id="strat3Title">ì†ì ˆ ê´€ë¦¬</div>
                        <div class="strategy-desc" id="strat3Desc">ì „ëµ ì„¤ëª…</div>
                    </div>
                </div>
            </div>
            
            <div class="data-summary">
                <h3>ğŸ“Š ë¶„ì„ ë°ì´í„°</h3>
                <div class="data-row">
                    <span class="data-label">ë¶„ì„ ìœ í˜•</span>
                    <span class="data-value" id="dataType">AI ì°¨íŠ¸</span>
                </div>
                <div class="data-row" id="dataNdfRow" style="display:none;">
                    <span class="data-label">NDF ê°­</span>
                    <span class="data-value" id="dataGap">-</span>
                </div>
                <div class="data-row" id="dataRsiRow">
                    <span class="data-label">RSI</span>
                    <span class="data-value" id="dataRsi">-</span>
                </div>
                <div class="data-row">
                    <span class="data-label">ì˜ˆìƒ ë°©í–¥</span>
                    <span class="data-value" id="dataDir">ğŸ“ˆ ìƒìŠ¹</span>
                </div>
            </div>
            
            <div class="warning-box">
                <h4>âš ï¸ ì£¼ì˜ì‚¬í•­</h4>
                <ul class="warning-list">
                    <li>ê¸°ìˆ ì  ë¶„ì„ì€ 100% ì •í™•í•˜ì§€ ì•Šì•„ìš”</li>
                    <li>RSI ê³¼ë§¤ìˆ˜ êµ¬ê°„ - ë‹¨ê¸° ì¡°ì • ê°€ëŠ¥ì„±</li>
                    <li>ì†ì ˆê°€ëŠ” ë°˜ë“œì‹œ ì§€ì¼œì£¼ì„¸ìš”</li>
                    <li>íˆ¬ì ì±…ì„ì€ ë³¸ì¸ì—ê²Œ ìˆì–´ìš”</li>
                </ul>
            </div>
            
            <button class="reset-btn" onclick="resetAll()">ğŸ”„ ë‹¤ì‹œ ë¶„ì„í•˜ê¸°</button>
        </div>
        
        <div class="footer">
            <p>ğŸ’± FX í™˜ìœ¨ AI ì°¨íŠ¸ ë¶„ì„ ê°€ì´ë“œ</p>
            <p>ê¸°ìˆ ì  ë¶„ì„ ê¸°ë°˜ ë§¤ë§¤ ì‹ í˜¸</p>
            <p style="margin-top:8px;">â€» íˆ¬ì ì±…ì„ì€ ë³¸ì¸ì—ê²Œ ìˆìŠµë‹ˆë‹¤</p>
        </div>
    </div>
    
    <script>
        // ì „ì—­ ë³€ìˆ˜
        let currentTab = 'ndf';
        let selectedTimeframe = '1h';
        let uploadedImageBase64 = null;
        let ndfResult = null;
        let chartResult = null;
        let aiAnalysisData = null;
        
        // ì‹œê³„
        function updateClock() {
            const now = new Date();
            const kr = new Intl.DateTimeFormat('ko-KR', {
                timeZone: 'Asia/Seoul',
                year: 'numeric', month: '2-digit', day: '2-digit',
                hour: '2-digit', minute: '2-digit', second: '2-digit',
                hour12: false
            }).formatToParts(now);
            
            let y,m,d,h,mi,s;
            kr.forEach(p => {
                if(p.type==='year') y=p.value;
                if(p.type==='month') m=p.value;
                if(p.type==='day') d=p.value;
                if(p.type==='hour') h=p.value;
                if(p.type==='minute') mi=p.value;
                if(p.type==='second') s=p.value;
            });
            
            document.getElementById('clock').textContent = `ğŸ‡°ğŸ‡· ${y}-${m}-${d} ${h}:${mi}:${s}`;
            
            const hour = parseInt(h);
            const seoulDay = new Date(now.toLocaleString('en-US',{timeZone:'Asia/Seoul'})).getDay();
            const status = document.getElementById('marketStatus');
            
            if(seoulDay===0||seoulDay===6) {
                status.textContent='ğŸ”´ ì£¼ë§ íœ´ì¥'; status.className='market-status closed';
            } else if(hour>=6&&hour<9) {
                status.textContent='ğŸŸ¡ NDF í™•ì¸ ìµœì !'; status.className='market-status optimal';
            } else if(hour>=9&&hour<16) {
                status.textContent='ğŸŸ¢ ì‹œì¥ ê±°ë˜ ì¤‘'; status.className='market-status open';
            } else {
                status.textContent='âšª ì‹œì¥ ë§ˆê°'; status.className='market-status closed';
            }
        }
        setInterval(updateClock,1000);
        updateClock();
        
        // íƒ­ ì „í™˜
        function switchTab(tab) {
            currentTab = tab;
            document.querySelectorAll('.tab-btn').forEach((b,i) => {
                b.classList.remove('active');
                if((tab==='ndf'&&i===0)||(tab==='chart'&&i===1)||(tab==='combined'&&i===2)) b.classList.add('active');
            });
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.getElementById(`tab-${tab}`).classList.add('active');
            document.getElementById('resultArea').classList.remove('show');
        }
        
        // NDF ì…ë ¥ ì²´í¬
        function checkNdfInputs() {
            const prev = parseFloat(document.getElementById('prevClose').value);
            const ndf = parseFloat(document.getElementById('ndfRate').value);
            
            document.getElementById('step1Status').textContent = prev>1000 ? 'ì™„ë£Œ âœ“' : 'ëŒ€ê¸°ì¤‘';
            document.getElementById('step1Status').className = prev>1000 ? 'step-status done' : 'step-status pending';
            
            document.getElementById('step2Status').textContent = ndf>1000 ? 'ì™„ë£Œ âœ“' : 'ëŒ€ê¸°ì¤‘';
            document.getElementById('step2Status').className = ndf>1000 ? 'step-status done' : 'step-status pending';
            
            document.getElementById('ndfAnalyzeBtn').disabled = !(prev>1000 && ndf>1000);
        }
        
        // íˆ¬ìê¸ˆ ì„¤ì •
        function setInvestment(amount) {
            document.getElementById('investment').value = amount;
            if(document.getElementById('investmentChart')) document.getElementById('investmentChart').value = amount;
            document.querySelectorAll('.invest-option').forEach(o => o.classList.remove('active'));
            event.target.classList.add('active');
        }
        
        // íƒ€ì„í”„ë ˆì„
        function setTimeframe(tf, el) {
            selectedTimeframe = tf;
            document.querySelectorAll('.timeframe-btn').forEach(b => b.classList.remove('active'));
            el.classList.add('active');
        }
        
        // ì°¨íŠ¸ ì—…ë¡œë“œ
        function handleChartUpload(e) {
            const file = e.target.files[0];
            if(!file || !file.type.startsWith('image/')) return;
            
            const reader = new FileReader();
            reader.onload = async function(ev) {
                uploadedImageBase64 = ev.target.result;
                
                document.getElementById('chartPreview').src = uploadedImageBase64;
                document.getElementById('uploadArea').style.display = 'none';
                document.getElementById('previewContainer').style.display = 'block';
                document.getElementById('chartStatus').textContent = 'ë¶„ì„ì¤‘...';
                document.getElementById('chartStatus').className = 'step-status analyzing';
                
                await analyzeChartWithAI(uploadedImageBase64);
            };
            reader.readAsDataURL(file);
        }
        
        // URLì—ì„œ ì°¨íŠ¸ ë¶ˆëŸ¬ì˜¤ê¸°
        async function fetchChartFromUrl() {
            const url = document.getElementById('chartUrl').value.trim();
            if(!url) {
                alert('ì´ë¯¸ì§€ URLì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            document.getElementById('chartStatus').textContent = 'ë¶ˆëŸ¬ì˜¤ëŠ”ì¤‘...';
            document.getElementById('chartStatus').className = 'step-status analyzing';
            
            try {
                // URLë¡œ ì§ì ‘ ë¶„ì„ ì‹œë„
                await analyzeChartWithAI(url);
            } catch(err) {
                console.error('URL ë¶„ì„ ì˜¤ë¥˜:', err);
                alert('ì´ë¯¸ì§€ë¥¼ ë¶ˆëŸ¬ì˜¤ê±°ë‚˜ ë¶„ì„í•˜ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.\nì§ì ‘ ì—…ë¡œë“œí•˜ê±°ë‚˜ ìˆ˜ë™ ì…ë ¥ì„ ì´ìš©í•´ì£¼ì„¸ìš”.');
                document.getElementById('chartStatus').textContent = 'ì˜¤ë¥˜';
                document.getElementById('chartStatus').className = 'step-status error';
            }
        }
        
        function removeChart() {
            uploadedImageBase64 = null;
            aiAnalysisData = null;
            document.getElementById('uploadArea').style.display = 'block';
            document.getElementById('previewContainer').style.display = 'none';
            document.getElementById('chartFile').value = '';
            document.getElementById('chartUrl').value = '';
            document.getElementById('chartStatus').textContent = 'ëŒ€ê¸°ì¤‘';
            document.getElementById('chartStatus').className = 'step-status pending';
            document.getElementById('aiResultCard').classList.remove('show');
            document.getElementById('timeframeCard').style.display = 'none';
            document.getElementById('chartAnalyzeBtn').disabled = true;
            updateCombinedCheck();
        }
        
        // Pollinations.ai Vision APIë¡œ ì°¨íŠ¸ ë¶„ì„
        async function analyzeChartWithAI(imageData) {
            const progress = document.getElementById('aiProgress');
            progress.classList.add('show');
            
            // ë‹¨ê³„ ì´ˆê¸°í™”
            const steps = ['aiStep1','aiStep2','aiStep3','aiStep4'];
            steps.forEach(s => {
                document.getElementById(s).classList.remove('active','done');
            });
            
            // ë‹¨ê³„ ì• ë‹ˆë©”ì´ì…˜
            let step = 0;
            const interval = setInterval(() => {
                if(step>0 && step<=4) {
                    document.getElementById(steps[step-1]).classList.remove('active');
                    document.getElementById(steps[step-1]).classList.add('done');
                }
                if(step<4) {
                    document.getElementById(steps[step]).classList.add('active');
                    step++;
                }
            }, 800);
            
            try {
                // ì´ë¯¸ì§€ ë°ì´í„° ì¤€ë¹„
                let imageUrl = imageData;
                
                // Pollinations.ai Vision API í˜¸ì¶œ
                const response = await fetch('https://text.pollinations.ai/', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        model: 'openai',
                        messages: [{
                            role: 'user',
                            content: [
                                {
                                    type: 'text',
                                    text: `You are an expert forex technical analyst. Analyze this USD/KRW chart image carefully.

Look for these indicators if visible:
- Current price (ì‹œê°€/í˜„ì¬ê°€)
- Bollinger Bands (BB) - upper, middle, lower bands
- RSI value
- MACD
- Stochastic RSI
- Support and resistance levels
- Price trend direction

RESPOND ONLY with this exact JSON format, no other text:
{
    "currentPrice": 1468,
    "resistance1": 1479,
    "resistance2": 1490,
    "support1": 1460,
    "support2": 1441,
    "rsi": 73.6,
    "stochRsi": 98.9,
    "macd": 1.13,
    "bbUpper": 1479,
    "bbMiddle": 1460,
    "bbLower": 1441,
    "trend": "up",
    "patterns": ["RSI ê³¼ë§¤ìˆ˜", "ë³¼ë¦°ì €ë°´ë“œ ìƒë‹¨ ê·¼ì ‘"],
    "comment": "RSIì™€ Stochastic RSIê°€ ëª¨ë‘ ê³¼ë§¤ìˆ˜ êµ¬ê°„ì— ìˆì–´ ë‹¨ê¸° ì¡°ì • ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ ê°•í•œ ìƒìŠ¹ ëª¨ë©˜í…€ì´ ìœ ì§€ë˜ê³  ìˆì–´ ì¶”ì„¸ëŠ” ìƒìŠ¹ ë°©í–¥ì…ë‹ˆë‹¤."
}

Use null for values you cannot determine. Prices should be realistic USD/KRW rates (1100-1700 range). RSI range is 0-100.`
                                },
                                {
                                    type: 'image_url',
                                    image_url: { url: imageUrl }
                                }
                            ]
                        }],
                        max_tokens: 1000
                    })
                });
                
                clearInterval(interval);
                steps.forEach(s => {
                    document.getElementById(s).classList.remove('active');
                    document.getElementById(s).classList.add('done');
                });
                
                if(!response.ok) {
                    throw new Error('API ì˜¤ë¥˜: ' + response.status);
                }
                
                const text = await response.text();
                console.log('API Response:', text);
                
                let data;
                try {
                    data = JSON.parse(text);
                    if(data.choices && data.choices[0] && data.choices[0].message) {
                        const content = data.choices[0].message.content;
                        const jsonMatch = content.match(/\{[\s\S]*\}/);
                        if(jsonMatch) {
                            data = JSON.parse(jsonMatch[0]);
                        }
                    }
                } catch(parseErr) {
                    // JSON ì¶”ì¶œ ì‹œë„
                    const jsonMatch = text.match(/\{[\s\S]*\}/);
                    if(jsonMatch) {
                        data = JSON.parse(jsonMatch[0]);
                    } else {
                        throw new Error('JSON íŒŒì‹± ì‹¤íŒ¨');
                    }
                }
                
                aiAnalysisData = data;
                
                setTimeout(() => {
                    progress.classList.remove('show');
                    displayAIResult(data);
                }, 500);
                
            } catch(err) {
                clearInterval(interval);
                console.error('AI Error:', err);
                progress.classList.remove('show');
                
                document.getElementById('chartStatus').textContent = 'ìˆ˜ë™ì…ë ¥ í•„ìš”';
                document.getElementById('chartStatus').className = 'step-status error';
                
                // ìˆ˜ë™ ì…ë ¥ ì•ˆë‚´
                alert('AIê°€ ì°¨íŠ¸ë¥¼ ë¶„ì„í•˜ì§€ ëª»í–ˆìŠµë‹ˆë‹¤.\n\nì•„ë˜ "ì°¨íŠ¸ ì •ë³´ ìˆ˜ë™ ì…ë ¥" ì„¹ì…˜ì—ì„œ\nì°¨íŠ¸ì— í‘œì‹œëœ ê°’ë“¤ì„ ì§ì ‘ ì…ë ¥í•´ì£¼ì„¸ìš”.\n\ní˜„ì¬ê°€: 1468.14\nRSI: 73.65\në“±ì˜ ê°’ì„ ì…ë ¥í•˜ì‹œë©´ ë©ë‹ˆë‹¤.');
            }
        }
        
        // AI ê²°ê³¼ í‘œì‹œ
        function displayAIResult(data) {
            document.getElementById('aiCurrentPrice').textContent = data.currentPrice ? data.currentPrice.toLocaleString() + 'ì›' : '-';
            document.getElementById('aiResistance1').textContent = data.resistance1 ? data.resistance1.toLocaleString() + 'ì›' : '-';
            document.getElementById('aiResistance2').textContent = data.resistance2 ? data.resistance2.toLocaleString() + 'ì›' : '-';
            document.getElementById('aiSupport1').textContent = data.support1 ? data.support1.toLocaleString() + 'ì›' : '-';
            document.getElementById('aiSupport2').textContent = data.support2 ? data.support2.toLocaleString() + 'ì›' : '-';
            
            // RSI í‘œì‹œ
            const rsiEl = document.getElementById('aiRSI');
            if(data.rsi) {
                rsiEl.textContent = data.rsi.toFixed(1);
                if(data.rsi > 70) {
                    rsiEl.className = 'ai-value overbought';
                    rsiEl.textContent += ' (ê³¼ë§¤ìˆ˜)';
                } else if(data.rsi < 30) {
                    rsiEl.className = 'ai-value oversold';
                    rsiEl.textContent += ' (ê³¼ë§¤ë„)';
                } else {
                    rsiEl.className = 'ai-value neutral';
                }
            } else {
                rsiEl.textContent = '-';
            }
            
            const trendMap = { up: 'ğŸ“ˆ ìƒìŠ¹', down: 'ğŸ“‰ í•˜ë½', sideways: 'â¡ï¸ íš¡ë³´' };
            const trendEl = document.getElementById('aiTrend');
            trendEl.textContent = trendMap[data.trend] || data.trend || '-';
            trendEl.className = 'ai-value ' + (data.trend==='up'?'up':data.trend==='down'?'down':'neutral');
            
            document.getElementById('aiPatterns').textContent = data.patterns ? data.patterns.join(', ') : '-';
            document.getElementById('aiComment').textContent = data.comment || 'AI ë¶„ì„ì´ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤.';
            
            document.getElementById('aiResultCard').classList.add('show');
            document.getElementById('timeframeCard').style.display = 'block';
            document.getElementById('chartStatus').textContent = 'ì™„ë£Œ âœ“';
            document.getElementById('chartStatus').className = 'step-status done';
            document.getElementById('chartAnalyzeBtn').disabled = false;
            
            // í”„ë¦¬ë·°ì— URL ì´ë¯¸ì§€ í‘œì‹œ
            if(!uploadedImageBase64 && document.getElementById('chartUrl').value) {
                document.getElementById('chartPreview').src = document.getElementById('chartUrl').value;
                document.getElementById('uploadArea').style.display = 'none';
                document.getElementById('previewContainer').style.display = 'block';
            }
            
            updateCombinedCheck();
        }
        
        // ìˆ˜ë™ ì…ë ¥ ë¶„ì„
        function analyzeManualInput() {
            const currentPrice = parseFloat(document.getElementById('manualCurrentPrice').value);
            const rsi = parseFloat(document.getElementById('manualRSI').value);
            const bbUpper = parseFloat(document.getElementById('manualBBUpper').value);
            const bbLower = parseFloat(document.getElementById('manualBBLower').value);
            const resistance1 = parseFloat(document.getElementById('manualResistance1').value);
            const support1 = parseFloat(document.getElementById('manualSupport1').value);
            const trend = document.getElementById('manualTrend').value;
            
            if(!currentPrice || currentPrice < 1000) {
                alert('í˜„ì¬ê°€ë¥¼ ì •í™•íˆ ì…ë ¥í•´ì£¼ì„¸ìš”. (ì˜ˆ: 1468.14)');
                return;
            }
            
            // íŒ¨í„´ ìë™ ê°ì§€
            const patterns = [];
            if(rsi > 70) patterns.push('RSI ê³¼ë§¤ìˆ˜');
            if(rsi < 30) patterns.push('RSI ê³¼ë§¤ë„');
            if(bbUpper && currentPrice > bbUpper * 0.99) patterns.push('ë³¼ë¦°ì €ë°´ë“œ ìƒë‹¨ ê·¼ì ‘');
            if(bbLower && currentPrice < bbLower * 1.01) patterns.push('ë³¼ë¦°ì €ë°´ë“œ í•˜ë‹¨ ê·¼ì ‘');
            if(trend === 'up') patterns.push('ìƒìŠ¹ ì¶”ì„¸');
            if(trend === 'down') patterns.push('í•˜ë½ ì¶”ì„¸');
            
            // ì½”ë©˜íŠ¸ ìƒì„±
            let comment = '';
            if(rsi > 70) {
                comment = 'RSIê°€ ê³¼ë§¤ìˆ˜ êµ¬ê°„ì— ìˆì–´ ë‹¨ê¸° ì¡°ì • ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤. ';
            } else if(rsi < 30) {
                comment = 'RSIê°€ ê³¼ë§¤ë„ êµ¬ê°„ì— ìˆì–´ ë°˜ë“± ê°€ëŠ¥ì„±ì´ ìˆìŠµë‹ˆë‹¤. ';
            }
            
            if(trend === 'up') {
                comment += 'ì „ë°˜ì ì¸ ì¶”ì„¸ëŠ” ìƒìŠ¹ ë°©í–¥ì…ë‹ˆë‹¤.';
            } else if(trend === 'down') {
                comment += 'ì „ë°˜ì ì¸ ì¶”ì„¸ëŠ” í•˜ë½ ë°©í–¥ì…ë‹ˆë‹¤.';
            } else {
                comment += 'í˜„ì¬ íš¡ë³´ êµ¬ê°„ìœ¼ë¡œ ë°©í–¥ ëŒ€ê¸° ì¤‘ì…ë‹ˆë‹¤.';
            }
            
            // ë°ì´í„° êµ¬ì„±
            aiAnalysisData = {
                currentPrice: currentPrice,
                resistance1: resistance1 || bbUpper || currentPrice * 1.007,
                resistance2: (resistance1 || bbUpper || currentPrice * 1.007) * 1.007,
                support1: support1 || bbLower || currentPrice * 0.993,
                support2: (support1 || bbLower || currentPrice * 0.993) * 0.993,
                rsi: rsi || null,
                bbUpper: bbUpper || null,
                bbMiddle: bbUpper && bbLower ? (bbUpper + bbLower) / 2 : null,
                bbLower: bbLower || null,
                trend: trend,
                patterns: patterns.length > 0 ? patterns : ['ìˆ˜ë™ ì…ë ¥ ë°ì´í„°'],
                comment: comment || 'ìˆ˜ë™ìœ¼ë¡œ ì…ë ¥ëœ ë°ì´í„°ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.'
            };
            
            displayAIResult(aiAnalysisData);
            
            document.getElementById('chartStatus').textContent = 'ìˆ˜ë™ì…ë ¥ ì™„ë£Œ';
            document.getElementById('chartStatus').className = 'step-status done';
        }
        
        // ë³µí•© ë¶„ì„ ì²´í¬
        function updateCombinedCheck() {
            const ndfDone = ndfResult !== null;
            const chartDone = aiAnalysisData !== null;
            
            document.getElementById('ndfCheck').textContent = ndfDone ? 'âœ…' : 'â¬œ';
            document.getElementById('chartCheck').textContent = chartDone ? 'âœ…' : 'â¬œ';
            
            const btn = document.getElementById('combinedBtn');
            btn.disabled = !(ndfDone && chartDone);
            btn.querySelector('.sub-text').textContent = (ndfDone && chartDone) ? 'ì¤€ë¹„ ì™„ë£Œ!' : 'NDFì™€ AIì°¨íŠ¸ ë¶„ì„ì„ ë¨¼ì € ì™„ë£Œí•˜ì„¸ìš”';
        }
        
        // NDF ë¶„ì„
        function analyzeNdf() {
            const prev = parseFloat(document.getElementById('prevClose').value);
            const ndf = parseFloat(document.getElementById('ndfRate').value);
            const investment = parseFloat(document.getElementById('investment').value) || 1000000;
            
            if(isNaN(prev) || isNaN(ndf) || prev<1000 || ndf<1000) {
                alert('ì˜¬ë°”ë¥¸ í™˜ìœ¨ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const gap = ndf - prev;
            const gapPct = (gap/prev)*100;
            const absGap = Math.abs(gap);
            
            let signal, signalClass, signalIcon, signalTitle, signalDesc;
            let entryPrice, targetPrice, stopPrice;
            let strategies = [];
            
            if(gap > 2) {
                signal = 'SELL_KRW';
                signalClass = 'sell-krw';
                signalIcon = 'ğŸŸ¢';
                signalTitle = 'ì›í™” ë§¤ë„';
                signalDesc = 'ë‹¬ëŸ¬ë¥¼ ì‚¬ì„¸ìš”! í™˜ìœ¨ ìƒìŠ¹ ì˜ˆìƒ';
                entryPrice = prev + gap*0.4;
                targetPrice = ndf + absGap*0.15;
                stopPrice = prev - absGap*0.4;
                strategies = [
                    {title:'9ì‹œ ê°­ìƒìŠ¹ í™•ì¸ í›„ ì§„ì…', desc:'ì‹œì´ˆê°€ê°€ ì „ì¼ì¢…ê°€ë³´ë‹¤ ë†’ìœ¼ë©´ ì§„ì…'},
                    {title:`ëª©í‘œê°€ ${targetPrice.toFixed(0)}ì›ì—ì„œ ì ˆë°˜ ì •ë¦¬`, desc:'ìš•ì‹¬ ë¶€ë¦¬ì§€ ë§ê³  ìˆ˜ìµ ì‹¤í˜„'},
                    {title:`ì†ì ˆê°€ ${stopPrice.toFixed(0)}ì› ì¤€ìˆ˜`, desc:'í•˜ë½ ì‹œ ë¬´ì¡°ê±´ ì •ë¦¬'}
                ];
            } else if(gap < -2) {
                signal = 'BUY_KRW';
                signalClass = 'buy-krw';
                signalIcon = 'ğŸ”´';
                signalTitle = 'ì›í™” ë§¤ìˆ˜';
                signalDesc = 'ë‹¬ëŸ¬ë¥¼ íŒŒì„¸ìš”! í™˜ìœ¨ í•˜ë½ ì˜ˆìƒ';
                entryPrice = prev + gap*0.4;
                targetPrice = ndf - absGap*0.15;
                stopPrice = prev + absGap*0.4;
                strategies = [
                    {title:'9ì‹œ ê°­í•˜ë½ í™•ì¸ í›„ ì§„ì…', desc:'ì‹œì´ˆê°€ê°€ ì „ì¼ì¢…ê°€ë³´ë‹¤ ë‚®ìœ¼ë©´ ì§„ì…'},
                    {title:`ëª©í‘œê°€ ${targetPrice.toFixed(0)}ì›ì—ì„œ ì ˆë°˜ ì •ë¦¬`, desc:'ìš•ì‹¬ ë¶€ë¦¬ì§€ ë§ê³  ìˆ˜ìµ ì‹¤í˜„'},
                    {title:`ì†ì ˆê°€ ${stopPrice.toFixed(0)}ì› ì¤€ìˆ˜`, desc:'ìƒìŠ¹ ì‹œ ë¬´ì¡°ê±´ ì •ë¦¬'}
                ];
            } else {
                signal = 'HOLD';
                signalClass = 'hold';
                signalIcon = 'ğŸŸ¡';
                signalTitle = 'ê´€ë§';
                signalDesc = 'ì˜¤ëŠ˜ì€ ì‰¬ì„¸ìš”! ë°©í–¥ ë¶ˆë¶„ëª…';
                entryPrice = prev;
                targetPrice = prev+5;
                stopPrice = prev-5;
                strategies = [
                    {title:'ì˜¤ì „ ì¶”ì´ ê´€ì°°', desc:'9~10ì‹œ íë¦„ì„ ì§€ì¼œë³´ì„¸ìš”'},
                    {title:'ëª…í™•í•œ ë°©í–¥ ëŒ€ê¸°', desc:'í™•ì‹¤í•œ ì¶”ì„¸ê°€ ë‚˜ì˜¬ ë•Œ ì§„ì…'},
                    {title:'ë¬´ë¦¬í•œ ì§„ì… ê¸ˆì§€', desc:'ì‹œê·¸ë„ ì•½í•  ë•ŒëŠ” ì†ì‹¤ í™•ë¥  ë†’ìŒ'}
                ];
            }
            
            let confidence;
            if(absGap>=15) confidence = Math.min(95, 75+absGap*0.5);
            else if(absGap>=10) confidence = 65+absGap*0.5;
            else if(absGap>=5) confidence = 45+absGap;
            else confidence = 25+absGap*2;
            
            ndfResult = {
                type:'ndf', signal, signalClass, signalIcon, signalTitle, signalDesc,
                entryPrice, targetPrice, stopPrice, strategies, confidence,
                prev, ndf, gap, gapPct, investment
            };
            
            updateCombinedCheck();
            displayResult(ndfResult);
        }
        
        // ì°¨íŠ¸ ë¶„ì„ ìµœì¢…í™”
        function finalizeChartAnalysis() {
            if(!aiAnalysisData) {
                alert('ì°¨íŠ¸ë¥¼ ë¨¼ì € ì—…ë¡œë“œí•˜ê±°ë‚˜ ìˆ˜ë™ ì…ë ¥í•´ì£¼ì„¸ìš”.');
                return;
            }
            
            const data = aiAnalysisData;
            const investment = parseFloat(document.getElementById('investmentChart').value) || 1000000;
            
            let signal, signalClass, signalIcon, signalTitle, signalDesc;
            let entryPrice, targetPrice, stopPrice;
            let strategies = [];
            let confidence = 60;
            
            const trend = data.trend || 'sideways';
            const rsi = data.rsi || 50;
            entryPrice = data.currentPrice || 1468;
            
            // RSI ê¸°ë°˜ ì‹ í˜¸ ì¡°ì •
            let rsiSignal = 'neutral';
            if(rsi > 70) rsiSignal = 'overbought';
            if(rsi < 30) rsiSignal = 'oversold';
            
            if(trend === 'up') {
                if(rsi > 80) {
                    // ê³¼ë§¤ìˆ˜ ìƒíƒœì—ì„œ ìƒìŠ¹ ì¶”ì„¸ - ì£¼ì˜ í•„ìš”
                    signal = 'HOLD';
                    signalClass = 'hold';
                    signalIcon = 'âš ï¸';
                    signalTitle = 'ê´€ë§ (ê³¼ë§¤ìˆ˜)';
                    signalDesc = 'ğŸ¤– ìƒìŠ¹ ì¶”ì„¸ì§€ë§Œ RSI ê³¼ë§¤ìˆ˜! ì¡°ì • ê°€ëŠ¥';
                    targetPrice = data.resistance1 || entryPrice*1.005;
                    stopPrice = data.support1 || entryPrice*0.99;
                    confidence = 45;
                    strategies = [
                        {title:'ì‹ ê·œ ì§„ì… ë³´ë¥˜', desc:`RSI ${rsi.toFixed(1)}ë¡œ ê³¼ë§¤ìˆ˜ ìƒíƒœ. ì¡°ì • í›„ ì§„ì…`},
                        {title:'ê¸°ì¡´ í¬ì§€ì…˜ ì¼ë¶€ ì •ë¦¬', desc:'ëª©í‘œê°€ ê·¼ì²˜ì—ì„œ ìˆ˜ìµ ì‹¤í˜„ ê³ ë ¤'},
                        {title:`ì§€ì§€ì„  ${(data.support1 || entryPrice*0.99).toFixed(0)}ì› ì£¼ì‹œ`, desc:'ì´íƒˆ ì‹œ ì¶”ê°€ í•˜ë½ ê°€ëŠ¥'}
                    ];
                } else {
                    signal = 'SELL_KRW';
                    signalClass = 'sell-krw';
                    signalIcon = 'ğŸŸ¢';
                    signalTitle = 'ì›í™” ë§¤ë„';
                    signalDesc = 'ğŸ¤– AI: ìƒìŠ¹ ì¶”ì„¸! ë‹¬ëŸ¬ ë§¤ìˆ˜';
                    targetPrice = data.resistance1 || entryPrice*1.01;
                    stopPrice = data.support1 || entryPrice*0.995;
                    confidence = 70;
                    strategies = [
                        {title:`í˜„ì¬ê°€ ${entryPrice.toFixed(0)}ì› ê·¼ì²˜ ì§„ì…`, desc:'ìƒìŠ¹ ì¶”ì„¸ í™œìš©'},
                        {title:`ì €í•­ì„  ${(data.resistance1 || entryPrice*1.01).toFixed(0)}ì›ì—ì„œ ì ˆë°˜ ì •ë¦¬`, desc:'1ì°¨ ëª©í‘œê°€ ë„ë‹¬ ì‹œ ìˆ˜ìµ ì‹¤í˜„'},
                        {title:`ì§€ì§€ì„  ${(data.support1 || entryPrice*0.995).toFixed(0)}ì› ì´íƒˆ ì‹œ ì†ì ˆ`, desc:'ì†ì‹¤ ì œí•œ í•„ìˆ˜'}
                    ];
                }
            } else if(trend === 'down') {
                if(rsi < 20) {
                    signal = 'HOLD';
                    signalClass = 'hold';
                    signalIcon = 'âš ï¸';
                    signalTitle = 'ê´€ë§ (ê³¼ë§¤ë„)';
                    signalDesc = 'ğŸ¤– í•˜ë½ ì¶”ì„¸ì§€ë§Œ RSI ê³¼ë§¤ë„! ë°˜ë“± ê°€ëŠ¥';
                    targetPrice = data.support1 || entryPrice*0.995;
                    stopPrice = data.resistance1 || entryPrice*1.01;
                    confidence = 45;
                    strategies = [
                        {title:'ì‹ ê·œ ë§¤ë„ ë³´ë¥˜', desc:`RSI ${rsi.toFixed(1)}ë¡œ ê³¼ë§¤ë„. ë°˜ë“± ê°€ëŠ¥`},
                        {title:'ê¸°ì¡´ ìˆí¬ì§€ì…˜ ì¼ë¶€ ì •ë¦¬', desc:'ê³¼ë§¤ë„ êµ¬ê°„ì—ì„œ ìˆ˜ìµ ì‹¤í˜„ ê³ ë ¤'},
                        {title:`ì €í•­ì„  ${(data.resistance1 || entryPrice*1.01).toFixed(0)}ì› ëŒíŒŒ ì£¼ì‹œ`, desc:'ëŒíŒŒ ì‹œ ì¶”ì„¸ ì „í™˜ ê°€ëŠ¥'}
                    ];
                } else {
                    signal = 'BUY_KRW';
                    signalClass = 'buy-krw';
                    signalIcon = 'ğŸ”´';
                    signalTitle = 'ì›í™” ë§¤ìˆ˜';
                    signalDesc = 'ğŸ¤– AI: í•˜ë½ ì¶”ì„¸! ë‹¬ëŸ¬ ë§¤ë„';
                    targetPrice = data.support1 || entryPrice*0.99;
                    stopPrice = data.resistance1 || entryPrice*1.005;
                    confidence = 70;
                    strategies = [
                        {title:`í˜„ì¬ê°€ ${entryPrice.toFixed(0)}ì› ê·¼ì²˜ ì§„ì…`, desc:'í•˜ë½ ì¶”ì„¸ í™œìš©'},
                        {title:`ì§€ì§€ì„  ${(data.support1 || entryPrice*0.99).toFixed(0)}ì›ì—ì„œ ì ˆë°˜ ì •ë¦¬`, desc:'1ì°¨ ëª©í‘œê°€ ë„ë‹¬ ì‹œ ìˆ˜ìµ ì‹¤í˜„'},
                        {title:`ì €í•­ì„  ${(data.resistance1 || entryPrice*1.005).toFixed(0)}ì› ëŒíŒŒ ì‹œ ì†ì ˆ`, desc:'ì†ì‹¤ ì œí•œ í•„ìˆ˜'}
                    ];
                }
            } else {
                signal = 'HOLD';
                signalClass = 'hold';
                signalIcon = 'ğŸŸ¡';
                signalTitle = 'ê´€ë§';
                signalDesc = 'ğŸ¤– AI: ë°©í–¥ ë¶ˆë¶„ëª…. ëŒ€ê¸° ê¶Œì¥';
                targetPrice = entryPrice + 5;
                stopPrice = entryPrice - 5;
                confidence = 40;
                strategies = [
                    {title:'ëª…í™•í•œ ë°©í–¥ ëŒ€ê¸°', desc:'íš¡ë³´ êµ¬ê°„ì€ ì§„ì… ë¦¬ìŠ¤í¬ ë†’ìŒ'},
                    {title:'ì§€ì§€/ì €í•­ ëŒíŒŒ í™•ì¸ í›„ ì§„ì…', desc:'ëŒíŒŒ ë°©í–¥ìœ¼ë¡œ ë”°ë¼ê°€ê¸°'},
                    {title:'ë¬´ë¦¬í•œ ì§„ì… ê¸ˆì§€', desc:'íš¡ë³´ ì‹œ ì†ì‹¤ í™•ë¥  ë†’ìŒ'}
                ];
            }
            
            chartResult = {
                type:'chart', signal, signalClass, signalIcon, signalTitle, signalDesc,
                entryPrice, targetPrice, stopPrice, strategies, confidence,
                aiData: data, investment, timeframe: selectedTimeframe, rsi
            };
            
            updateCombinedCheck();
            displayResult(chartResult);
        }
        
        // ë³µí•© ë¶„ì„
        function analyzeCombined() {
            if(!ndfResult || !aiAnalysisData) {
                alert('NDFì™€ AIì°¨íŠ¸ ë¶„ì„ì„ ë¨¼ì € ì™„ë£Œí•´ì£¼ì„¸ìš”.');
                return;
            }
            
            if(!chartResult) {
                finalizeChartAnalysis();
            }
            
            const ndf = ndfResult;
            const chart = chartResult;
            const signalsMatch = ndf.signal === chart.signal;
            
            let signal, signalClass, signalIcon, signalTitle, signalDesc;
            let entryPrice, targetPrice, stopPrice;
            let strategies = [];
            let confidence;
            
            if(signalsMatch && ndf.signal !== 'HOLD') {
                signal = ndf.signal;
                signalClass = ndf.signalClass;
                signalIcon = ndf.signalIcon;
                signalTitle = ndf.signalTitle;
                signalDesc = 'ğŸ”¥ NDF + AI ì‹œê·¸ë„ ì¼ì¹˜! ê°•ë ¥ ì¶”ì²œ';
                
                entryPrice = chart.entryPrice;
                if(signal === 'SELL_KRW') {
                    targetPrice = Math.min(ndf.targetPrice, chart.targetPrice);
                    stopPrice = Math.max(ndf.stopPrice, chart.stopPrice);
                } else {
                    targetPrice = Math.max(ndf.targetPrice, chart.targetPrice);
                    stopPrice = Math.min(ndf.stopPrice, chart.stopPrice);
                }
                
                confidence = Math.min(95, (ndf.confidence + chart.confidence)/2 + 15);
                
                strategies = [
                    {title:'âœ¨ ë‘ ì‹œê·¸ë„ ì¼ì¹˜!', desc:`NDFì™€ AI ëª¨ë‘ ${signalTitle}. ì ê·¹ ì§„ì… ê°€ëŠ¥`},
                    {title:`ë³´ìˆ˜ì  ëª©í‘œê°€ ${targetPrice.toFixed(0)}ì›`, desc:'ë‘ ë¶„ì„ ì¤‘ ê°€ê¹Œìš´ ëª©í‘œë¡œ ì•ˆì „í•˜ê²Œ'},
                    {title:`ì•ˆì „ ì†ì ˆê°€ ${stopPrice.toFixed(0)}ì›`, desc:'ë‘ ë¶„ì„ ì¤‘ ì•ˆì „í•œ ì†ì ˆì„ '}
                ];
            } else if(signalsMatch && ndf.signal === 'HOLD') {
                signal = 'HOLD';
                signalClass = 'hold';
                signalIcon = 'ğŸŸ¡';
                signalTitle = 'ê´€ë§';
                signalDesc = 'NDFì™€ AI ëª¨ë‘ ë°©í–¥ ë¶ˆë¶„ëª…';
                entryPrice = chart.entryPrice;
                targetPrice = entryPrice + 5;
                stopPrice = entryPrice - 5;
                confidence = 30;
                strategies = [
                    {title:'ì˜¤ëŠ˜ì€ ì‰¬ì„¸ìš”', desc:'ë‘ ë¶„ì„ ëª¨ë‘ ë°©í–¥ ë¶ˆë¶„ëª…'},
                    {title:'ì˜¤í›„ ì¶”ì´ ê´€ì°°', desc:'ëª…í™•í•œ ë°©í–¥ì´ ë‚˜ì˜¬ ë•Œê¹Œì§€ ëŒ€ê¸°'},
                    {title:'ë‚´ì¼ ë‹¤ì‹œ ë¶„ì„', desc:'ë¬´ë¦¬í•œ ì§„ì…ë³´ë‹¤ ê¸°ë‹¤ë¦¼ì´ ìˆ˜ìµ'}
                ];
            } else {
                // ì‹œê·¸ë„ ë¶ˆì¼ì¹˜ - NDF ìš°ì„ í•˜ë˜ ì£¼ì˜
                signal = ndf.signal;
                signalClass = ndf.signalClass;
                signalIcon = 'âš ï¸';
                signalTitle = ndf.signalTitle + ' (ì£¼ì˜)';
                signalDesc = 'âš ï¸ NDFì™€ AI ì‹œê·¸ë„ ë¶ˆì¼ì¹˜! ì‹ ì¤‘í•˜ê²Œ';
                entryPrice = chart.entryPrice;
                targetPrice = ndf.targetPrice;
                stopPrice = Math.max(ndf.stopPrice, chart.stopPrice);
                confidence = Math.min(55, (ndf.confidence + chart.confidence)/2 - 10);
                strategies = [
                    {title:'âš ï¸ ì†Œì•¡ìœ¼ë¡œ í…ŒìŠ¤íŠ¸', desc:'ì‹œê·¸ë„ ë¶ˆì¼ì¹˜. í‰ì†Œë³´ë‹¤ ì ê²Œ ì§„ì…'},
                    {title:'NDF ë°©í–¥ ìš°ì„ ', desc:`NDF=${ndf.signalTitle}, AI=${chart.signalTitle}`},
                    {title:'íƒ€ì´íŠ¸í•œ ì†ì ˆ', desc:`${stopPrice.toFixed(0)}ì›ì—ì„œ ë¹ ë¥´ê²Œ ì†ì ˆ`}
                ];
            }
            
            const result = {
                type:'combined', signal, signalClass, signalIcon, signalTitle, signalDesc,
                entryPrice, targetPrice, stopPrice, strategies, confidence,
                ndf, chart, signalsMatch, rsi: chart.rsi
            };
            
            displayResult(result);
        }
        
        // ê²°ê³¼ í‘œì‹œ
        function displayResult(result) {
            const investment = result.investment || result.ndf?.investment || 1000000;
            
            // ë°°ì§€
            const badge = document.getElementById('analysisBadge');
            if(result.type === 'ndf') {
                badge.className = 'analysis-badge ndf';
                badge.innerHTML = 'ğŸ“Š NDF ë¶„ì„';
            } else if(result.type === 'chart') {
                badge.className = 'analysis-badge ai';
                badge.innerHTML = 'ğŸ¤– AI ì°¨íŠ¸ ë¶„ì„';
            } else {
                badge.className = 'analysis-badge combined';
                badge.innerHTML = 'ğŸ”¥ NDF + AI ë³µí•©';
            }
            
            // ë©”ì¸ ì‹œê·¸ë„
            document.getElementById('mainSignal').className = `main-signal ${result.signalClass}`;
            document.getElementById('signalIcon').textContent = result.signalIcon;
            document.getElementById('signalTitle').textContent = result.signalTitle;
            document.getElementById('signalDesc').textContent = result.signalDesc;
            
            setTimeout(() => {
                document.getElementById('confidenceFill').style.width = result.confidence + '%';
            }, 100);
            document.getElementById('confidenceValue').textContent = result.confidence.toFixed(0) + '%';
            
            // ê°€ê²©
            document.getElementById('entryPrice').textContent = result.entryPrice.toLocaleString('ko-KR',{maximumFractionDigits:0}) + 'ì›';
            document.getElementById('targetPrice').textContent = result.targetPrice.toLocaleString('ko-KR',{maximumFractionDigits:0}) + 'ì›';
            document.getElementById('stopPrice').textContent = result.stopPrice.toLocaleString('ko-KR',{maximumFractionDigits:0}) + 'ì›';
            
            const targetDiff = result.targetPrice - result.entryPrice;
            document.getElementById('targetChange').textContent = (targetDiff>=0?'+':'') + targetDiff.toFixed(0) + 'ì›';
            document.getElementById('targetChange').className = 'change ' + (targetDiff>=0?'positive':'negative');
            
            const stopDiff = result.stopPrice - result.entryPrice;
            document.getElementById('stopChange').textContent = (stopDiff>=0?'+':'') + stopDiff.toFixed(0) + 'ì›';
            document.getElementById('stopChange').className = 'change ' + (stopDiff>=0?'positive':'negative');
            
            // ìˆ˜ìµ/ì†ì‹¤
            const profitPerWon = Math.abs(result.targetPrice - result.entryPrice);
            const lossPerWon = Math.abs(result.entryPrice - result.stopPrice);
            const profit = (profitPerWon / result.entryPrice) * investment;
            const loss = (lossPerWon / result.entryPrice) * investment;
            
            document.getElementById('maxProfit').textContent = '+' + Math.round(profit).toLocaleString() + 'ì›';
            document.getElementById('profitDesc').textContent = (investment/10000).toFixed(0) + 'ë§Œì› ê¸°ì¤€';
            document.getElementById('maxLoss').textContent = '-' + Math.round(loss).toLocaleString() + 'ì›';
            
            // ì „ëµ
            result.strategies.forEach((s,i) => {
                document.getElementById(`strat${i+1}Title`).textContent = s.title;
                document.getElementById(`strat${i+1}Desc`).textContent = s.desc;
            });
            
            // ë°ì´í„° ìš”ì•½
            const typeMap = {ndf:'NDF ë¶„ì„', chart:'AI ì°¨íŠ¸', combined:'ë³µí•© ë¶„ì„'};
            document.getElementById('dataType').textContent = typeMap[result.type];
            
            if(result.type === 'ndf' || result.type === 'combined') {
                document.getElementById('dataNdfRow').style.display = 'flex';
                const gap = result.gap || result.ndf?.gap;
                const gapPct = result.gapPct || result.ndf?.gapPct;
                document.getElementById('dataGap').textContent = (gap>=0?'+':'') + gap.toFixed(1) + 'ì› (' + (gapPct>=0?'+':'') + gapPct.toFixed(2) + '%)';
                document.getElementById('dataGap').className = 'data-value ' + (gap>=0?'up':'down');
            } else {
                document.getElementById('dataNdfRow').style.display = 'none';
            }
            
            // RSI í‘œì‹œ
            if(result.rsi || result.aiData?.rsi || result.chart?.rsi) {
                const rsi = result.rsi || result.aiData?.rsi || result.chart?.rsi;
                document.getElementById('dataRsiRow').style.display = 'flex';
                const rsiEl = document.getElementById('dataRsi');
                rsiEl.textContent = rsi.toFixed(1);
                if(rsi > 70) {
                    rsiEl.textContent += ' (ê³¼ë§¤ìˆ˜)';
                    rsiEl.className = 'data-value down';
                } else if(rsi < 30) {
                    rsiEl.textContent += ' (ê³¼ë§¤ë„)';
                    rsiEl.className = 'data-value up';
                } else {
                    rsiEl.className = 'data-value';
                }
            } else {
                document.getElementById('dataRsiRow').style.display = 'none';
            }
            
            const dir = document.getElementById('dataDir');
            if(result.signal === 'SELL_KRW') {
                dir.textContent = 'ğŸ“ˆ ìƒìŠ¹ ì˜ˆìƒ';
                dir.className = 'data-value up';
            } else if(result.signal === 'BUY_KRW') {
                dir.textContent = 'ğŸ“‰ í•˜ë½ ì˜ˆìƒ';
                dir.className = 'data-value down';
            } else {
                dir.textContent = 'â¡ï¸ íš¡ë³´/ê´€ë§';
                dir.className = 'data-value';
            }
            
            document.getElementById('resultArea').classList.add('show');
            document.getElementById('mainSignal').scrollIntoView({behavior:'smooth', block:'start'});
        }
        
        // ë¦¬ì…‹
        function resetAll() {
            document.getElementById('resultArea').classList.remove('show');
            document.getElementById('prevClose').value = '';
            document.getElementById('ndfRate').value = '';
            document.getElementById('step1Status').textContent = 'ëŒ€ê¸°ì¤‘';
            document.getElementById('step1Status').className = 'step-status pending';
            document.getElementById('step2Status').textContent = 'ëŒ€ê¸°ì¤‘';
            document.getElementById('step2Status').className = 'step-status pending';
            document.getElementById('ndfAnalyzeBtn').disabled = true;
            
            removeChart();
            
            // ìˆ˜ë™ ì…ë ¥ ì´ˆê¸°í™”
            document.getElementById('manualCurrentPrice').value = '';
            document.getElementById('manualRSI').value = '';
            document.getElementById('manualBBUpper').value = '';
            document.getElementById('manualBBLower').value = '';
            document.getElementById('manualResistance1').value = '';
            document.getElementById('manualSupport1').value = '';
            
            ndfResult = null;
            chartResult = null;
            aiAnalysisData = null;
            updateCombinedCheck();
            
            window.scrollTo({top:0, behavior:'smooth'});
        }
        
        // í˜ì´ì§€ ë¡œë“œ ì‹œ ìƒ˜í”Œ ë°ì´í„° ì œì•ˆ (ì—…ë¡œë“œëœ ì°¨íŠ¸ ê¸°ì¤€)
        window.addEventListener('DOMContentLoaded', function() {
            // ìƒ˜í”Œ ì°¨íŠ¸ ë°ì´í„°ë¥¼ ìˆ˜ë™ ì…ë ¥ í•„ë“œì— íŒíŠ¸ë¡œ í‘œì‹œ
            document.getElementById('manualCurrentPrice').placeholder = '1468.14';
            document.getElementById('manualRSI').placeholder = '73.65';
            document.getElementById('manualBBUpper').placeholder = '1478.77';
            document.getElementById('manualBBLower').placeholder = '1441.45';
            document.getElementById('manualResistance1').placeholder = '1479';
            document.getElementById('manualSupport1').placeholder = '1460';
        });
    </script>
</body>
</html>
